# QSPR.pxp Igor Pro Experiment File

`QSPR.pxp` is a packed WaveMetrics Igor Pro 8 experiment file containing macros and compiled functions to perform:

- Regularized (multivariate) multiple linear regression ((M)MLR)
- Univariate logistic regression (LGR)

These regressions use molecular descriptors as explanatory variables, along with other numerical parameters.

---

## 🔗 Dependencies and Input Files

- Molecular descriptors can be imported from an **HTF5** file generated by the program [`chemical_descriptor.py`](https://github.com/AD-SDL/redoxmer_python_kinetics_analysis).
- An example input file is `des.h5`.
- Example input CSV files for MLR and LGR regressions are also provided.
- The program requires the **HDF5-64.xop** extension to read HDF5 descriptor files (`*.h5`).
- On first use, you will be prompted to specify the folder where the procedure (`*.ipf`) files are located.

---

## 📂 Procedure Files Overview

- `file_io.ipf` and `service.ipf`: service functions
- `gen_discrete.ipf`: Genetic algorithm routines
- `qspr.ipf`: Main procedure file containing MMLR and LGR regression
- `qspr_cross_validation.ipf`: Cross-validation using random data splitting
- `LinReg.ipf`: Igor implementation of linear algebra for regularized linear and logistic regression

---

## ⚙️ Using the Macros and Procedures

- Macros and procedures are available via the **Macros** and **QSPR** drop-down menus at the top of the Igor Pro window.
- Key macros:
  - `MLR_Genetics`
  - `LGR_Genetics` (found under **Macros**)
- Important QSPR functions:
  - `QSPR -> Descriptors -> CreateSet_HDF5_des`: Reads the `des.h5` molecular descriptors file
  - `QSPR -> CVS import -> LoadCSV_table`: Reads input CSV files with dependent variables and explanatory parameters

---

## 🎯 Program Workflow

1. Set the target number of descriptors.
2. The program uses genetic algorithm optimization to find a descriptor set minimizing RMS error (or logistic analog).
3. Hashing and starring (under **QSPR -> Hash and Star**) exclude or require specific descriptors.
4. Visualization options include plots, tables, and MP4 videos.
5. `QSPR -> Sets` provides macros to save, export, and import data sets and fits.

---

## 📬 Contact

For questions on how to use this software, please contact:

**Eli Shkrob**  
📧 shkrob@anl.gov  
📧 shkrobius@gmail.com
